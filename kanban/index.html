<html>
    <head>
        <script src="https://unpkg.com/vue@3"></script>
        <script src="js/task_handling.js"></script>
        
        <link href='https://fonts.googleapis.com/css?family=Open Sans' rel='stylesheet'> 
        <link href='css/dialog.css' rel='stylesheet'> 
        <link href='css/layout.css' rel='stylesheet'> 
        <link href='css/settings.css' rel='stylesheet'> 
        <link href='css/load.css' rel='stylesheet'> 
    </head>
    <body>
        <div id="app">
            <!-- Masthead -->
            <header class="masthead">
                <img src="assets/logo.svg" style="width:55px;height:40px;margin:5px;"/>
                <div style="font-size:13pt;color:white;">看板 / kanban / iciban</div>
                <div class="user-settings">
                    <button class="mast_button" onclick="showSettings();">
                        <img src="assets/settings.svg"/>
                    </button>
                    <button class="mast_button" onclick="showLoad();">
                        <img src="assets/open.svg"/>
                    </button>
                    <button class="mast_button" onclick="downloadData();">
                        <img src="assets/download.svg"/>
                    </button>
                </div>
            </header>
            <!-- End of masthead -->
        
            <!-- Lists container -->
            <section class="lists-container">
                <!-- main phases layout -->
                <div v-bind:category="category.name" class="list" v-for="category in categories" 
                    @dragover.prevent @dragenter.prevent ondrop="onDrop(event)">
                    <!-- phase header -->
                    <h3 class="list-title">{{category.name}}<button v-if="category.name == 'New'" 
                        onclick="taskDialog()" class="category_title">+</button>
                    </h3>
            
                    <ul class="list-items" v-for="task in filterTasks(category.name)">
                        <li v-bind:data-id="task.id" draggable="true" ondragstart="startDrag(event);" style="position:relative;">
                            <div class="task_name">{{task.name}}</div>
                            <span class="task_priority" v-bind:class="task.priority">{{task.priority}}</span>
                            <img src="assets/user.svg" class="user_icon"/>
                            <span class="assign_to" >{{task.assign}}</span>
                            <span v-if="task.due != ''" class="due_date"><b>due</b>: {{task.due}}</span>
                            <img v-bind:data-id="task.id" class="sidebutton" src="assets/edit.svg" 
                                alt="edit" style="top:10px;" onclick="editNode(this.parentElement)"/>
                            <img v-bind:data-id="task.id" class="sidebutton" src="assets/delete.svg" 
                                alt="remove" style="top:40px;" onclick="removeNode(this)"/>
                        </li>
                    </ul>
                </div>
                <!-- add new task -->
                <div class="overlay" id="dialog">
                    <div class="modal">
                    <table>
                        <tr><td>Task</td></tr>
                        <tr><td><textarea id="newTaskInfo" placeholder="Enter task here" class="dialog_task_info"></textarea></td></tr>          
                        <tr><td><hr/></td></tr>
                        <tr><td>Assign to</td></tr>
                        <tr><td>
                            <select id="assign" class="dialog_assign">
                                <option v-for="user in users" v-bind:value="user.name">{{user.name}}</option>
                            </select>
                        </td></tr>
                        <tr><td>Priority</td></tr>
                        <tr><td>
                            <select id="priority" class="dialog_priority">
                                <option value="P1">P1</option>
                                <option value="P2" selected>P2</option>
                                <option value="P3">P3</option>
                                <option value="P4">P4</option>
                            </select>
                        </td></tr>
                        <tr><td><hr/></td></tr>
                        <tr><td><input id="datecheck" type="checkbox" onclick="openPicker(this);"/>
                            <input type="date" id="duedate" class="dialog_due_date"/>Due date</td></tr>
                        </tr>
                        <tr><td>
                            <button onclick="updateTask()" class="dialog_button" style="margin-left: 135;">Apply</button>
                            <button onclick="resetDialog()" style="margin-left: 5;" class="dialog_button" >Cancel</button></td></tr>
                        </table>
                    </div>
                </div>
            </section>  <!-- end of Lists container -->

            <!-- load data fragment -->
            <div class="overlay" id="load">
                <div class="load_root">
                    <image src="assets/close.svg" class="close_load_button" onclick="hideLoad()"/>
                    <h1>Kanban data</h1>
                    <div class="settings_description">
                        You can reset your kanban board, you can modify your kanban data here. Or you can paste in a
                        downloaded version of kanban. To modify, click on 'Update' button. To reset the board, click on
                        'New' button.
                    </div>
                    <hr>
                    <textarea id="kanban_data" class="data_display"></textarea>
                    <div>
                        <button class="command_button" style="margin-left:165px;width:100px;" onclick="resetKanbanData()">
                            New
                        </button>
                        <button class="command_button" style="margin-left:10px;width:100px;" onclick="updateKanbanData()">
                            Update
                        </button>
                        <button class="command_button" style="margin-left:10px;width:100px;" onclick="copyKanbanData()">
                            Copy
                        </button>
                    </div>
                </div>
            </div> <!-- end of load data -->

            <!-- settings fragment -->
            <div class="overlay" id="settings">
                <div class="settings_root">
                    <image src="assets/close.svg" class="close_button" onclick="hideSettings()"/>
                    <h1>Settings</h1>
                    <div class="settings_description">
                        Settings are applied right after changes are made. When all the changes are made, 
                        click 'x' button on the top right to dismiss Settings.
                    </div>
                    <hr>
                    <h2>User list</h2>
                    <div  class="settings_description">
                        This is the list of users available when dealing with task. If you want to assign 
                        task to more users, add it here.
                    </div>
                    <select id="user_list" size="5" class="settings_list">
                        <option v-for="user in users" >{{user.name}}</option>
                    </select>
                    <div>
                        <button class="command_button" style="width:200px;" onclick="removeUser();">
                            Remove selected user
                        </button>
                    </div>
                    <div>
                        <input id="newUserName" type="text" placeholder="enter new user here" class="settings_input"/>
                    </div>
                    <div>
                        <button class="command_button" style="width:100px;" onclick="addUser(true)">
                            Add before
                        </button>
                        <button class="command_button" style="margin-left:0px;width:100px;" onclick="addUser(false)">
                            Add after
                        </button>
                    </div>
                    <hr>
                    <h2>Progression list</h2>
                    <div class="settings_description">
                        The purpose of Kanban board is to track progression of task from one phase to the next. 
                        Phases are different for different line of work. You can customize the phases needed.
                    </div>
                    
                    <select id="category_list" size="7"  class="settings_list">
                        <option v-for="category in categories">
                            {{category.name}}
                        </option>
                    </select>
                    <div>
                        <button class="command_button"  style="width:200px;" onclick="removeCategory();">
                            Remove selected phase
                        </button>
                    </div>
                    <div>
                        <input id="newCategoryName" type="text" placeholder="enter new phase here" class="settings_input"/>
                    </div>
                    <div>
                        <button class="command_button" style="width:100px;" onclick="addCategory(true)">
                            Add before
                        </button>
                        <button class="command_button" style="margin-left:0px;width:100px;" onclick="addCategory(false)">
                            Add after
                        </button>
                    </div>
                </div>
            </div> <!-- end of settings fragment -->
        </div> <!-- end of app div -->
        <script src="js/kanban_vue_app.js"></script>
    </body>
</html>


